% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dgm_individual.R
\name{dgm_individual}
\alias{dgm_individual}
\title{Generating simulated individual-level Data FusioMR Analysis}
\usage{
dgm_individual(m, nx, ny, a_gamma, b_gamma, a_f, b_f, a_alpha, b_alpha, theta)
}
\arguments{
\item{m}{Integer. Number of genetic variants (SNPs) to simulate.}

\item{nx}{Integer. Sample size for the exposure study.}

\item{ny}{Integer. Sample size for the outcome study.}

\item{a_gamma}{Numeric. Lower bound for IV-to-exposure effect sizes.}

\item{b_gamma}{Numeric. Upper bound for IV-to-exposure effect sizes.}

\item{a_f}{Numeric. Lower bound for MAF.}

\item{b_f}{Numeric. Upper bound for MAF.}

\item{a_alpha}{Numeric. Lower bound for horizontal pleiotropy effects.}

\item{b_alpha}{Numeric. Upper bound for horizontal pleiotropy effects.}

\item{theta}{Numeric. True causal effect of exposure on outcome.}
}
\value{
A list containing:
\describe{
  \item{X}{Numeric vector of length \code{nx}. Simulated exposure values for exposure study.}
  \item{Y}{Numeric vector of length \code{ny}. Simulated outcome values for outcome study.}
  \item{gx}{Numeric matrix of dimension \code{m x nx}. Standardized genotype matrix for exposure study.}
  \item{gy}{Numeric matrix of dimension \code{m x ny}. Standardized genotype matrix for outcome study.}
  \item{gamma}{Numeric vector of length \code{m}. True IV-to-exposure effect sizes.}
  \item{alpha}{Numeric vector of length \code{m}. True horizontal pleiotropy effects.}
  \item{f}{Numeric vector of length \code{m}. Minor allele frequencies used for simulation.}
  \item{theta}{Numeric scalar. True causal effect used in simulation.}
}
}
\description{
This function generates simulated individual-level data for two-sample
Mendelian Randomization analysis with potential horizontal pleiotropy.
}
\details{
The data generation model follows the structure:
\deqn{X = \gamma^T G_X + \epsilon_X}
\deqn{Y = \alpha^T G_Y + \theta X_Y + \epsilon_Y}

where:
\itemize{
  \item \eqn{G_X, G_Y} are standardized genotype matrices for exposure and outcome studies
  \item \eqn{\gamma} represents valid IV-to-exposure effects (instrument strength)
  \item \eqn{\alpha} represents horizontal pleiotropy effects
  \item \eqn{\theta} is the causal effect
  \item \eqn{\epsilon_X, \epsilon_Y} are standard normal error terms
}

Genotypes are simulated from binomial distributions with varying MAFs,
then standardized to have mean 0 and variance 1 for each SNP.
}
\examples{
# Basic usage with default parameters
set.seed(123)
sim_data <- dgm_individual(
  m = 50,           # 50 genetic variants
  nx = 10000,       # 10,000 individuals in exposure study
  ny = 10000,       # 10,000 individuals in outcome study
  a_gamma = 0.1,    # IV effects between 0.1 and 0.3
  b_gamma = 0.3,
  a_f = 0.05,       # MAF between 5\% and 45\%
  b_f = 0.45,
  a_alpha = -0.1,   # Pleiotropy effects between -0.1 and 0.1
  b_alpha = 0.1,
  theta = 0.5       # True causal effect of 0.5
)

# Check dimensions
length(sim_data$X)  # Should be 10000
length(sim_data$Y)  # Should be 10000
dim(sim_data$gx)    # Should be 50 x 10000
dim(sim_data$gy)    # Should be 50 x 10000

# Scenario with no horizontal pleiotropy
sim_valid <- dgm_individual(
  m = 20, nx = 5000, ny = 5000,
  a_gamma = 0.2, b_gamma = 0.4,
  a_f = 0.1, b_f = 0.4,
  a_alpha = 0, b_alpha = 0,  # No pleiotropy
  theta = 0.3
)

}
